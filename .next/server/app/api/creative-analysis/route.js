"use strict";(()=>{var e={};e.id=248,e.ids=[248],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1210:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>d,staticGenerationAsyncStorage:()=>g});var i={};r.r(i),r.d(i,{GET:()=>m,POST:()=>u});var n=r(9303),o=r(8716),a=r(670),s=r(7070),c=r(7422);async function u(e){try{var t;let{creativeScores:r,businessPriorities:i={},campaignType:n="conversion",includeAwardBenchmark:o=!0}=await e.json();if(!r||"object"!=typeof r)return s.NextResponse.json({error:"creativeScores object is required"},{status:400});let a=c.Wx.calculateBusinessEffectiveness(r,i,n),u=null;o&&(u={businessEfficiencyAlignment:Math.round((a.outcomeBreakdown.media_efficiency||0)/10),conversionAlignment:Math.round((a.outcomeBreakdown.conversion||0)/10),overallBusinessPotential:Math.round(a.totalScore),gapAnalysis:a.businessRecommendations||[]});let m=c.ko.map(e=>{let t=r[e.id]||0,i=a.featureROI[e.id]||0,n=Object.entries(c.M2).map(([r,i])=>({outcome:i.name,impact:e.businessImpact[r]||0,score:t*(e.businessImpact[r]||0)})).sort((e,t)=>t.score-e.score);return{name:e.id,description:e.description,category:e.category,currentScore:t,contribution:Math.round(100*i)/100,measurability:e.measurability,topOutcomes:n.slice(0,3),implementation:e.implementation,businessImpact:e.businessImpact,gap:t<7?10-t:0}}).sort((e,t)=>t.contribution-e.contribution),l=Object.entries(c.M2).map(([e,t])=>{let n=a.outcomeBreakdown[e]||0,o=t.threshold,s=t.targetValue,u=c.ko.map(t=>({name:t.id,impact:t.businessImpact[e]||0,currentContribution:(r[t.id]||0)*(t.businessImpact[e]||0)})).sort((e,t)=>t.impact-e.impact).slice(0,3);return{outcome:t.name,metrics:t.metrics,currentScore:Math.round(100*n)/100,targetScore:s,threshold:o,weight:t.weight,performance:n>=o?"above_threshold":"below_threshold",gapToTarget:Math.max(0,s-n),topFeatures:u,priority:i[e]||1}}).sort((e,t)=>t.currentScore-e.currentScore),p=function(e,t,r,i){let n=[];for(let e of t.filter(e=>e.currentScore<6&&e.contribution>.5).slice(0,2))n.push({type:"feature_improvement",priority:"high",title:`Boost ${e.name.replace(/_/g," ")}`,description:`Current score: ${e.currentScore}/10. High business impact feature with significant improvement potential.`,impact:"High business effectiveness improvement expected",actions:e.implementation.slice(0,2),timeline:"2-3 weeks"});for(let e of r.filter(e=>"below_threshold"===e.performance).slice(0,2))n.push({type:"outcome_optimization",priority:"medium",title:`Improve ${e.outcome}`,description:`Currently ${Math.round(e.currentScore)} vs target ${e.targetScore}`,impact:`${e.gapToTarget} point improvement needed`,actions:e.topFeatures.map(e=>`Enhance ${e.name.replace(/_/g," ")}`),timeline:"3-4 weeks"});if("conversion"===i){let e=t.find(e=>"action_oriented_language"===e.name);e&&e.currentScore<8&&n.push({type:"campaign_type_optimization",priority:"high",title:"Strengthen Action-Oriented Language",description:"Conversion campaigns require compelling action triggers",impact:"Direct conversion rate improvement",actions:["Command-form CTAs","Active voice usage","Specific action verbs"],timeline:"1-2 weeks"})}return n.slice(0,5)}(0,m,l,n),g={overallCES:a.totalScore,grade:(t=a.totalScore)>=85?"A+":t>=80?"A":t>=75?"A-":t>=70?"B+":t>=65?"B":t>=60?"B-":t>=55?"C+":t>=50?"C":"C-",strengthAreas:m.filter(e=>e.currentScore>=8).map(e=>e.name),improvementAreas:m.filter(e=>e.currentScore<6).map(e=>e.name),balanceScore:function(e){let t=Object.values(e),r=t.reduce((e,t)=>e+t,0)/t.length,i=t.reduce((e,t)=>e+Math.pow(t-r,2),0)/t.length;return Math.max(0,10-Math.sqrt(i))}(r),executionReadiness:function(e){let t=e.filter(e=>"high"===e.measurability&&e.currentScore>=7).length,r=e.filter(e=>"high"===e.measurability).length;return r>0?t/r*10:0}(m)};return s.NextResponse.json({analysis:{campaignHealth:g,cesScore:a.totalScore,outcomeBreakdown:a.outcomeBreakdown,featureContributions:a.featureROI,recommendations:a.businessRecommendations},insights:{features:m,outcomes:l,strategic:p},benchmarks:u,metadata:{campaignType:n,analysisTimestamp:new Date().toISOString(),totalFeatures:c.ko.length,businessOutcomes:Object.keys(c.M2).length}})}catch(e){return console.error("Creative analysis error:",e),s.NextResponse.json({error:"Failed to analyze creative effectiveness"},{status:500})}}async function m(e){try{let{searchParams:t}=new URL(e.url),r=t.get("format")||"summary";if("features"===r)return s.NextResponse.json({features:c.ko.map(e=>({id:e.id,name:e.name,description:e.description,category:e.category,measurability:e.measurability,implementation:e.implementation,businessImpact:e.businessImpact,testability:e.testability})),categories:{content:c.ko.filter(e=>"content"===e.category).length,design:c.ko.filter(e=>"design"===e.category).length,messaging:c.ko.filter(e=>"messaging"===e.category).length,targeting:c.ko.filter(e=>"targeting"===e.category).length,channel:c.ko.filter(e=>"channel"===e.category).length}});if("outcomes"===r)return s.NextResponse.json({outcomes:Object.entries(c.M2).map(([e,t])=>({id:e,name:t.name,description:t.description,metrics:t.metrics,weight:t.weight,targetValue:t.targetValue,threshold:t.threshold}))});return s.NextResponse.json({summary:{totalFeatures:c.ko.length,categories:["content","design","messaging","targeting","channel"],businessOutcomes:Object.keys(c.M2).length,businessFocus:"Pure business outcomes (no award correlations)"},usage:{endpoint:"/api/creative-analysis",method:"POST",requiredFields:["creativeScores"],optionalFields:["businessPriorities","campaignType","includeAwardBenchmark"]}})}catch(e){return console.error("Error fetching creative analysis info:",e),s.NextResponse.json({error:"Failed to fetch creative analysis information"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/creative-analysis/route",pathname:"/api/creative-analysis",filename:"route",bundlePath:"app/api/creative-analysis/route"},resolvedPagePath:"/Users/tbwa/Documents/GitHub/ai-agency/app/api/creative-analysis/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:d}=l,h="/api/creative-analysis/route";function f(){return(0,a.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[276,972,422],()=>r(1210));module.exports=i})();