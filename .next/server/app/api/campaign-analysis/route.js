"use strict";(()=>{var e={};e.id=397,e.ids=[397],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5315:e=>{e.exports=require("path")},392:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>S,patchFetch:()=>j,requestAsyncStorage:()=>b,routeModule:()=>v,serverHooks:()=>x,staticGenerationAsyncStorage:()=>y});var n={};a.r(n),a.d(n,{GET:()=>f,POST:()=>h});var r=a(9303),s=a(8716),i=a(670),o=a(7070),c=a(7422);let l=require("fs");var m=a.n(l),p=a(5315),u=a.n(p);let d=()=>{try{let e="/Users/tbwa/Documents/GitHub/campaign-insight-accelerator/dist",t=JSON.parse(m().readFileSync(u().join(e,"campaigns.json"),"utf8")),a=JSON.parse(m().readFileSync(u().join(e,"creative_assets.json"),"utf8")),n=m().readFileSync(u().join(e,"performance_metrics.csv"),"utf8").split("\n").slice(1).filter(e=>e.trim()).map(e=>{let[t,a,n,r,s,i,o,c,l,m,p,u,d,_,g,f,h]=e.split(",");return{metric_id:t||"",campaign_id:a||"",date:n||"",roi:parseFloat(r||"0"),brand_recall:parseFloat(s||"0"),engagement_rate:parseFloat(i||"0"),reach:parseInt(o||"0"),impressions:parseInt(c||"0"),clicks:parseInt(l||"0"),ctr:parseFloat(m||"0"),conversion_rate:parseFloat(p||"0"),cost_per_acquisition:parseFloat(u||"0"),sentiment_score:parseFloat(d||"0"),video_completion_rate:parseFloat(_||"0"),share_rate:parseFloat(g||"0"),save_rate:parseFloat(f||"0"),tenant_id:h||""}});return{campaigns:t,creativeAssets:a,performanceMetrics:n}}catch(e){return console.error("Error loading real data:",e),null}},_=e=>({value_proposition_clarity:10*e.text_readability,urgency_scarcity_triggers:"Excitement"===e.emotional_trigger?8:5,social_proof_integration:"Prominent"===e.brand_integration?9:"Subtle"===e.brand_integration?6:3,problem_solution_framing:10*e.performance_score,visual_hierarchy_optimization:10*e.visual_distinctness,color_psychology_application:10*e.color_harmony,mobile_optimization:e.dimensions?.includes("300x")?9:e.dimensions?.includes("728x")?7:8,benefit_focused_headlines:10*e.text_readability,action_oriented_language:"Urgency"===e.emotional_trigger?9:"Excitement"===e.emotional_trigger?7:5,personalization_depth:e.a_b_test_variant?8:4,behavioral_targeting_precision:10*e.performance_score,lookalike_audience_optimization:7,platform_native_optimization:"mp4"===e.format?9:"svg"===e.format?8:7,cross_channel_consistency:7.5}),g=e=>{if(0===e.length)return{};let t=e.reduce((e,t)=>(e.roi+=t.roi,e.brand_recall+=t.brand_recall,e.engagement_rate+=t.engagement_rate,e.conversion_rate+=t.conversion_rate,e.sentiment_score+=t.sentiment_score,e.ctr+=t.ctr,e.video_completion_rate+=t.video_completion_rate,e.share_rate+=t.share_rate,e.save_rate+=t.save_rate,e),{roi:0,brand_recall:0,engagement_rate:0,conversion_rate:0,sentiment_score:0,ctr:0,video_completion_rate:0,share_rate:0,save_rate:0}),a=e.length;return Object.keys(t).forEach(e=>{t[e]/=a}),{engagement:7.5*t.engagement_rate,brand_recall:t.brand_recall,conversion:6*t.conversion_rate,roi_sales:Math.min(60*t.roi,500),brand_sentiment:100*t.sentiment_score,acquisition:12*t.ctr,media_efficiency:Math.max(100-t.cost_per_acquisition/10,50),behavioral_response:t.video_completion_rate/100*60,brand_equity:(t.brand_recall+100*t.sentiment_score)/2}};async function f(e){let{searchParams:t}=new URL(e.url),a=t.get("campaignId"),n=parseInt(t.get("limit")||"10"),r=t.get("type")||"summary",s=d();if(!s)return o.NextResponse.json({error:"Failed to load campaign data"},{status:500});let{campaigns:i,creativeAssets:l,performanceMetrics:m}=s;if("summary"===r)return o.NextResponse.json({summary:{totalCampaigns:i.length,totalCreativeAssets:l.length,totalPerformanceRecords:m.length,businessOutcomes:Object.keys(c.M2).length,businessFeatures:c.ko.length,industries:[...new Set(i.map(e=>e.industry))],regions:[...new Set(i.map(e=>e.region))],brands:[...new Set(i.map(e=>e.brand))]}});if(a){let e=i.find(e=>e.campaign_id===a);if(!e)return o.NextResponse.json({error:"Campaign not found"},{status:404});let t=l.filter(e=>e.campaign_id===a),n=m.filter(e=>e.campaign_id===a);if(0===t.length)return o.NextResponse.json({error:"No creative assets found for campaign"},{status:404});let r=_(t[0]),s=g(n),p=c.Wx.calculateBusinessEffectiveness(r,{},"conversion");return o.NextResponse.json({campaign:e,analysis:{businessEffectivenessScore:p.totalScore,predictedOutcomes:p.outcomeBreakdown,actualOutcomes:s,featureScores:r,recommendations:p.businessRecommendations,implementationPlan:p.implementationPlan},assets:t.length,performanceRecords:n.length})}let p=i.slice(0,n).map(e=>{let t=l.filter(t=>t.campaign_id===e.campaign_id),a=m.filter(t=>t.campaign_id===e.campaign_id);if(0===t.length)return{...e,analysis:null,assets:0,performanceRecords:a.length};let n=_(t[0]);g(a);let r=c.Wx.calculateBusinessEffectiveness(n,{},"conversion");return{...e,analysis:{businessEffectivenessScore:r.totalScore,topBusinessOutcome:Object.entries(r.outcomeBreakdown).sort(([,e],[,t])=>t-e)[0],actualPerformance:{roi:a.length>0?a.reduce((e,t)=>e+t.roi,0)/a.length:0,engagement:a.length>0?a.reduce((e,t)=>e+t.engagement_rate,0)/a.length:0,conversion:a.length>0?a.reduce((e,t)=>e+t.conversion_rate,0)/a.length:0}},assets:t.length,performanceRecords:a.length}});return o.NextResponse.json({campaigns:p,total:i.length,analyzed:p.length})}async function h(e){try{let{campaignIds:t,analysisType:a="batch",businessPriorities:n={}}=await e.json(),r=d();if(!r)return o.NextResponse.json({error:"Failed to load campaign data"},{status:500});let{campaigns:s,creativeAssets:i,performanceMetrics:l}=r;if("batch"===a&&t){let e=t.map(e=>{let t=s.find(t=>t.campaign_id===e);if(!t)return null;let a=i.filter(t=>t.campaign_id===e);if(l.filter(t=>t.campaign_id===e),0===a.length)return null;let r=a[0],o=_(r),m=c.Wx.calculateBusinessEffectiveness(o,n,"conversion");return{campaignId:e,campaignName:t.name,brand:t.brand,businessEffectivenessScore:m.totalScore,topRecommendation:m.businessRecommendations[0],businessOutcomes:m.outcomeBreakdown}}).filter(Boolean);return o.NextResponse.json({batchAnalysis:e,summary:{totalAnalyzed:e.length,averageScore:e.reduce((e,t)=>e+t.businessEffectivenessScore,0)/e.length,topPerformers:e.sort((e,t)=>t.businessEffectivenessScore-e.businessEffectivenessScore).slice(0,5)}})}return o.NextResponse.json({error:"Invalid analysis type or missing campaign IDs"},{status:400})}catch(e){return console.error("Campaign analysis error:",e),o.NextResponse.json({error:"Failed to analyze campaigns"},{status:500})}}let v=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/campaign-analysis/route",pathname:"/api/campaign-analysis",filename:"route",bundlePath:"app/api/campaign-analysis/route"},resolvedPagePath:"/Users/tbwa/Documents/GitHub/ces-standalone/app/api/campaign-analysis/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:b,staticGenerationAsyncStorage:y,serverHooks:x}=v,S="/api/campaign-analysis/route";function j(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:y})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[276,972,422],()=>a(392));module.exports=n})();